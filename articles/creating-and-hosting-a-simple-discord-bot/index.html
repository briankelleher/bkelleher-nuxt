<!doctype html>
<html data-n-head-ssr lang="en" data-n-head="%7B%22lang%22:%7B%22ssr%22:%22en%22%7D%7D">
  <head>
    <title>Brian Kelleher</title><meta data-n-head="ssr" charset="utf-8"><meta data-n-head="ssr" name="viewport" content="width=device-width,initial-scale=1"><meta data-n-head="ssr" data-hid="description" name="description" content=""><meta data-n-head="ssr" name="format-detection" content="telephone=no"><link data-n-head="ssr" rel="icon" type="image/x-icon" href="/favicon.ico"><link rel="preload" href="/_nuxt/d742747.js" as="script"><link rel="preload" href="/_nuxt/900b283.js" as="script"><link rel="preload" href="/_nuxt/87eb4cc.js" as="script"><link rel="preload" href="/_nuxt/eb224da.js" as="script"><link rel="preload" href="/_nuxt/381879a.js" as="script"><link rel="preload" href="/_nuxt/4e74c3e.js" as="script"><style data-vue-ssr-id="b13bd09c:0 b13bd09c:1 517a8dd7:0 fa7ff0ca:0 7783a668:0 166b59b9:0 2f9548d1:0 d64adc92:0">@import url(https://fonts.googleapis.com/css2?family=Archivo+Narrow:wght@400;700&family=Merriweather:ital,wght@0,300;0,700;1,300&display=swap);.dark-btn{cursor:pointer;text-decoration:underline;color:#00f}html.dark,html.dark body{background-color:#15202b;color:#fff}html.dark body a,html.dark body a:visited{color:#fff}html.dark body .post .post-tags a{color:#000}html.dark body .article-row .article-read-more,html.dark body .article-row .article-title-link,html.dark body .post .post-tags a:hover{color:#fff}*{font-family:Merriweather,serif}html{background-color:#f1f1f1}h1,h2,h3,h4,h5,h6{font-family:"Archivo Narrow",sans-serif;font-weight:700}h1,h2{font-size:40px}h3{font-size:30px}.nuxt-content-container h3{font-size:48px}body{margin:0}.contain{max-width:1070px;margin:0 auto;padding:0 32px}.page{margin-top:24px}.page.contain{max-width:1070px;margin:0 auto}.row{display:flex;grid-column-gap:20px;-moz-column-gap:20px;column-gap:20px}.row .col{flex:1}.article-row{padding-top:24px;padding-bottom:24px;margin-bottom:8px}.article-row .article-type{color:grey;letter-spacing:1px;text-transform:uppercase;font-family:sans-serif;font-size:12px;margin:0 0 8px}.article-row .article-title-link{text-decoration:none;color:#000;font-family:"Archivo Narrow",sans-serif;font-weight:700}.article-row .article-title-link:hover{text-decoration:underline}.article-row .article-title{margin-top:0;margin-bottom:20px}.article-row .article-excerpt{font-size:18px;line-height:1.8}.article-row .article-excerpt>*{margin-top:0;margin-bottom:16px}.article-row .article-read-more{color:#00f}.post .post-title{font-size:48px}.post .post-content{max-width:78ch;line-height:1.8;font-size:20px}.post .post-content>*{margin:0 0 32px}.post .post-content *+h2,.post .post-content *+h3,.post .post-content *+h4,.post .post-content *+h5,.post .post-content *+h6{margin-top:88px}.post .post-content pre{overflow-x:visible}.post .post-content pre.no-wrap{overflow-x:scroll}@media(max-width:1000px){.post .post-content pre.wp-block-code,.post .post-content pre.wp-block-preformatted{overflow-x:scroll}}.post .post-categories,.post .post-tags{margin-bottom:24px}.post .post-tags{max-width:100%;display:flex;flex-wrap:wrap;align-content:space-between}.post .post-tags a{font-family:"Archivo Narrow",sans-serif;font-weight:400;letter-spacing:1px;padding:6px 24px;margin-right:16px;margin-bottom:16px;text-decoration:none;background:#eaeaea;border-radius:15px;color:#000;font-size:16px}.post .post-tags a:hover{background-color:#15202b;color:#fff}.post .post-project-link{color:#fff;margin-bottom:24px;display:inline-block;padding:8px 24px;letter-spacing:1px;font-family:"Archivo Narrow",sans-serif;text-decoration:none;font-weight:700;text-transform:uppercase;background-color:#385bda;box-shadow:0 5px #0420ad;border-radius:4px}.post .post-project-link:hover{color:#fff;box-shadow:0 3px #0420ad;top:2px;position:relative}pre[class*=language-] span.token{background-color:transparent}.nuxt-content-highlight pre[class*=language-],pre[class*=language-]{white-space:pre-wrap;font-family:monospace;padding:20px;background-color:#000;color:#fff;font-size:16px;border-radius:5px;font-weight:400;text-shadow:none}.nuxt-content-highlight pre[class*=language-].no-wrap,pre[class*=language-].no-wrap{white-space:pre;overflow-x:visible}@media(max-width:1000px){.nuxt-content-highlight pre[class*=language-],.nuxt-content-highlight pre[class*=language-].wp-block-preformatted,pre[class*=language-],pre[class*=language-].wp-block-preformatted{white-space:pre}}code{font-family:monospace}@media(max-width:1000px){code{white-space:pre}}@media(max-width:1000px){.wp-block-code{overflow-x:scroll}}.wp-block-code.no-wrap code{white-space:pre}@media(max-width:1000px){.wp-block-code code{white-space:pre}}.page code[class*=language-],.page pre[class*=language-]{font-size:15px}.page code[class*=language-],.page code[class*=language-] span,.page pre[class*=language-],.page pre[class*=language-] span{font-family:Consolas,Monaco,"Andale Mono","Ubuntu Mono",monospace}figure{margin-top:0}figure img{max-width:100%;height:auto}figure figcaption{font-size:13px;min-width:300px}figure.aligncenter figcaption{text-align:center}footer{min-height:150px}code[class*=language-],pre[class*=language-]{color:#000;background:0 0;text-shadow:0 1px #fff;font-family:Consolas,Monaco,"Andale Mono","Ubuntu Mono",monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-ms-hyphens:none;hyphens:none}code[class*=language-] ::-moz-selection,code[class*=language-]::-moz-selection,pre[class*=language-] ::-moz-selection,pre[class*=language-]::-moz-selection{text-shadow:none;background:#b3d4fc}code[class*=language-] ::selection,code[class*=language-]::selection,pre[class*=language-] ::selection,pre[class*=language-]::selection{text-shadow:none;background:#b3d4fc}@media print{code[class*=language-],pre[class*=language-]{text-shadow:none}}pre[class*=language-]{padding:1em;margin:.5em 0;overflow:auto}:not(pre)>code[class*=language-],pre[class*=language-]{background:#f5f2f0}:not(pre)>code[class*=language-]{padding:.1em;border-radius:.3em;white-space:normal}.token.cdata,.token.comment,.token.doctype,.token.prolog{color:#708090}.token.punctuation{color:#999}.token.namespace{opacity:.7}.token.boolean,.token.constant,.token.deleted,.token.number,.token.property,.token.symbol,.token.tag{color:#905}.token.attr-name,.token.builtin,.token.char,.token.inserted,.token.selector,.token.string{color:#690}.language-css .token.string,.style .token.string,.token.entity,.token.operator,.token.url{color:#9a6e3a;background:hsla(0,0%,100%,.5)}.token.atrule,.token.attr-value,.token.keyword{color:#07a}.token.class-name,.token.function{color:#dd4a68}.token.important,.token.regex,.token.variable{color:#e90}.token.bold,.token.important{font-weight:700}.token.italic{font-style:italic}.token.entity{cursor:help}.nuxt-progress{position:fixed;top:0;left:0;right:0;height:2px;width:0;opacity:1;transition:width .1s,opacity .4s;background-color:#000;z-index:999999}.nuxt-progress.nuxt-progress-notransition{transition:none}.nuxt-progress-failed{background-color:red}.default-layout[data-v-60df20fd]{margin-top:40px;margin-bottom:60px}.top-bar .site-header .header-link[data-v-40d14d74]{text-decoration:none;color:#000}.top-bar .site-header .header-description[data-v-40d14d74]{color:#8a8a8a;font-family:sans-serif;font-weight:400;font-size:18px}.top-bar .top-bar-nav[data-v-40d14d74]{border-bottom:1px solid #d0cfcf;list-style-type:none;padding:0 0 24px;display:flex;justify-content:flex-start;align-items:center;grid-column-gap:16px;-moz-column-gap:16px;column-gap:16px}.top-bar .top-bar-nav .navigation-link[data-v-40d14d74]{color:#00f}.dark .top-bar .site-header .header-link[data-v-40d14d74],.dark .top-bar .top-bar-nav .navigation-link[data-v-40d14d74]{color:#fff}.dark .article-slug .article-meta{color:#c1c5cb}.article-slug{margin-top:30px}.article-slug h2{font-size:60px;margin-bottom:4px}.article-slug .article-meta{font-family:"Archivo Narrow",sans-serif;margin-bottom:60px;font-size:18px;color:#525252}.article-slug .nuxt-content{line-height:1.8;font-size:20px;margin-bottom:60px}.article-slug .nuxt-content>*{margin:0 0 32px}.article-slug .nuxt-content *+h2,.article-slug .nuxt-content *+h3,.article-slug .nuxt-content *+h4,.article-slug .nuxt-content *+h5,.article-slug .nuxt-content *+h6{margin-top:88px}.article-slug .nuxt-content pre{overflow-x:visible;font-family:monospace}.article-slug .nuxt-content pre code,.article-slug .nuxt-content pre code span{font-family:monospace}.article-slug .nuxt-content .nuxt-content-highlight{background-color:rgba(38,38,38,.54);border-top-left-radius:5px;border-top-right-radius:5px}.article-slug .nuxt-content .nuxt-content-highlight span.filename{font-family:monospace;font-size:14px;margin-left:20px}.article-image[data-v-3be05b54]{margin-top:12px;margin-bottom:12px}.article-image img[data-v-3be05b54]{margin:0 auto;display:block}.article-image figcaption[data-v-3be05b54]{text-align:center;margin-top:12px}</style><link rel="preload" href="/_nuxt/static/1648826722/articles/creating-and-hosting-a-simple-discord-bot/state.js" as="script"><link rel="preload" href="/_nuxt/static/1648826722/articles/creating-and-hosting-a-simple-discord-bot/payload.js" as="script"><link rel="preload" href="/_nuxt/static/1648826722/manifest.js" as="script">
  </head>
  <body>
    <div data-server-rendered="true" id="__nuxt"><!----><div id="__layout"><div class="default-layout" data-v-60df20fd><div class="top-bar contain" data-v-40d14d74 data-v-60df20fd><header class="site-header" data-v-40d14d74><a href="/" class="header-link nuxt-link-active" data-v-40d14d74><h1 data-v-40d14d74>Brian Kelleher</h1></a> <a class="btn dark-btn" data-v-40d14d74>Toggle Dark Mode</a> <h1 class="header-description" data-v-40d14d74>
      Full-Stack Web Developer in Denver, CO
    </h1></header> <nav class="top-bar-nav contain" data-v-40d14d74><a href="/articles" class="nuxt-link-active" data-v-40d14d74>
      Articles
    </a> <a href="https://twitter.com/b_kelleher" data-v-40d14d74>Twitter</a></nav></div> <div class="article-slug contain" data-v-60df20fd><h2>Creating and Hosting a Simple Discord Bot</h2> <p class="article-meta">
    Last Updated: April 1, 2022
  </p> <div class="nuxt-content"><p><a href="https://discord.com/" rel="nofollow noopener noreferrer" target="_blank">Discord</a> is an increasingly popular chat application. With origins in the gaming community, it has been quickly realized by hobbyist groups, industries, and communities as an effective cross-platform communication tool.</p>
<p>The flexibility of Discord is unparalleled in any other chat app, and aside from its rich customizable permission and role system, it provides a rather simple API to build applications for. On top of that, there is a very well maintained NodeJS library that makes the job even easier, called Discord.js.</p>
<p>In this short tutorial I will show you how to get started writing an application for Discord, particularly a “Discord Bot”, and how to host it.</p>
<p>I will assume you have at least a basic understanding of:</p>
<ul>
<li>the Discord platform</li>
<li>NodeJS</li>
<li>Git / Version Control</li>
</ul>
<p>I will cover:</p>
<ul>
<li>Setting up a Discord Developer account, and an application</li>
<li>Creating the project on your local machine and providing some example code to help you get started</li>
<li>Hosting the bot on DigitalOcean’s App Platform via Github</li>
<li>Strategies for continued development</li>
</ul>
<p>Requirements to get started:</p>
<ul>
<li>NodeJS 14+ installed locally</li>
<li>A <a href="https://discord.com" rel="nofollow noopener noreferrer" target="_blank">Discord.com</a> account and ability to log into the developer portal to create applications</li>
<li>I highly recommend having the Discord app installed on your local machine, but you can use the browser</li>
<li>You will need to create a test discord server for yourself. You should be prompted to do this if you are not part of any existing discord servers, otherwise use the Plus icon on the left sidebar.</li>
</ul>
<h3 id="registering-a-discord-application"><a href="#registering-a-discord-application" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Registering a Discord Application</h3>
<p>To start working on your bot, you will need to have an account on <a href="https://discord.com" rel="nofollow noopener noreferrer" target="_blank">Discord.com</a>. Once you have one, you can visit the Developer Applications page to create your first application. In the Discord hierarchy, an application is an overarching project that has one or multiple integrations with Discord, and a “bot” is a unique part of an application that can perform operations in the Discord chat app. Thus, in order to create a bot, we must create an application.</p>
<p>In the top right corner of the page, there should be a button for “New Application”. You will be prompted for an application name. Now, there are plenty of different ways to develop a bot locally while also maintaining a bot in production using the same tokens, however I’ve found that an extremely effective method is to maintain two “applications” (one for production, and one for local development), and thus having two different bots. If you envision yourself doing this with your bot, I would name your Application something like <code>&lt;your-application-name>-dev</code>, otherwise any simple name for your application will be fine for demo purposes.</p>
<figure class="article-image" data-v-3be05b54><img src="/_nuxt/img/discord-intro-popup.73d7a8c.png" alt="The popup interface for creating a new Discord Application" style="max-width:650px" data-v-3be05b54> <figcaption data-v-3be05b54>The popup interface for creating a new Discord Application.</figcaption></figure>
<p>Once you successfully create an application, you should be redirected to an application management page with a few menu options on the left. Before we leave this area, take note of the Client ID number below your Application description, as we will need it later. Navigate to the link on the left that says “Bot”.</p>
<p>Here, we will need to set a username, which is the name that will be presented to other Discord users when your bot is sending messages. Right below the username is a place to reveal and manage your bot token as well, which we will need later.</p>
<figure class="article-image" data-v-3be05b54><img src="/_nuxt/img/discord-build-a-bot.14b5d69.png" alt="The username and token management area for your Discord Bot." style="max-width:720px" data-v-3be05b54> <figcaption data-v-3be05b54>The username and token management area for your Discord Bot.</figcaption></figure>
<h3 id="adding-your-bot-to-your-discord-server"><a href="#adding-your-bot-to-your-discord-server" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Adding Your Bot to Your Discord Server</h3>
<p>Now, in the project requirements I mention having a test discord server ready for use. If you have not already, log into the discord chat application on your desktop (or the application on their website) and enter that server. The first thing we are going to do is add your bot to the test server.</p>
<p>In order to do that, we need two things: the Client ID we retrieved earlier, and a Permission Integer. A permission integer is essentially a number that maps to a set of permissions for a discord user. Since a bot is treated as just another discord user, we have to set some base permissions in order for it to have its full capabilities. Discord makes this very easy.</p>
<p>To create the Permissions Integer, you must navigate to the bottom of the Bot management page, to the section labelled “Bot Permissions”. Here you can select the permissions your bot will need to perform its duties, and the tool will generate a permissions integer for you at the bottom. Here is an example basic set of permissions that we can use to simply send messages to any basic, open channel:</p>
<figure class="article-image" data-v-3be05b54><img src="/_nuxt/img/discord-bot-permissions.9aca3fa.png" alt="An example set of permissions for a basic Discord Bot." style="max-width:920px" data-v-3be05b54> <figcaption data-v-3be05b54>An example set of permissions for a basic Discord Bot.</figcaption></figure>
<p>At the time of authoring, your bot by default is private. In order to add the bot to your server, you must enter a URL into your browser to prompt it. The URL should be formed as such, replacing {your-client-id} and {your-bot-permission-integer}:</p>
<div class="nuxt-content-highlight"><pre class="line-numbers language-text"><code>https://discordapp.com/api/oauth2/authorize?client_id={your-client-id}&scope=bot&permissions={your-bot-permission-integer}
</code></pre></div>
<p>Here, you should be prompted to select the server to add the bot to, and asked to accept any requested permissions for the bot. After successfully adding your bot to your server, you should see a message in your test server welcoming your bot, and the bot should now be listed on the Member List (which can be opened by selecting the icon in the top right of Discord that looks like two people). Since your bot is not running, your bot should appear in the “Offline” section, but in any case an example of my member list when the bot is running:</p>
<figure class="article-image" data-v-3be05b54><img src="/_nuxt/img/discord-member-list.f50c89d.png" alt="Example Member List when Discord Bot is added successfully." style="max-width:400px" data-v-3be05b54> <figcaption data-v-3be05b54>Example Member List when Discord Bot is added successfully.</figcaption></figure>
<p>Using this same OAuth2 URL method, you can add this bot to any server you have permission to. It’s as simple as that. Now, we can start developing the actual bot code.</p>
<h3 id="writing-the-bot-code"><a href="#writing-the-bot-code" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Writing the Bot Code</h3>
<p>We can start by navigating to a project directory in your local command prompt, and for these purposes I will be simulating working in a MacOS terminal.</p>
<div class="nuxt-content-highlight"><pre class="line-numbers language-bash"><code><span class="token function">npm</span> init
</code></pre></div>
<p>Use NPM init to initialize your project directory as a NodeJS project. Next, we will need to install the following packages:</p>
<div class="nuxt-content-highlight"><pre class="line-numbers language-bash"><code><span class="token function">npm</span> i axios discord.js
</code></pre></div>
<p>While doing this, please ensure that the version of discord.js installed is >= 12.0.0. I will be referencing a specific API that is not supported in versions earlier than this.</p>
<p>Next, we need to write the entry point for the application.</p>
<div class="nuxt-content-highlight"><pre class="line-numbers language-bash"><code><span class="token function">touch</span> index.js
</code></pre></div>
<p>Open up this index.js file in your preferred text editor, and lets get started:</p>
<div class="nuxt-content-highlight"><span class="filename">index.js</span><pre class="line-numbers language-js"><code><span class="token comment">// index.js</span>
<span class="token comment">// Import all necessary libraries, commands, and functions.</span>
<span class="token keyword">const</span> <span class="token maybe-class-name">Discord</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'discord.js'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> client <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Discord<span class="token punctuation">.</span>Client</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> http <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'http'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token constant">CLIENT_LOGIN_KEY</span> <span class="token operator">=</span> process<span class="token punctuation">.</span><span class="token property-access">env</span><span class="token punctuation">.</span><span class="token constant">CLIENT_LOGIN_KEY</span> <span class="token operator">||</span> <span class="token string">'Your-Dev-Bot-Token-Here'</span><span class="token punctuation">;</span>

<span class="token comment">// When the bot is logged in and ready to go</span>
client<span class="token punctuation">.</span><span class="token method function property-access">on</span><span class="token punctuation">(</span><span class="token string">'ready'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
    <span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Logged in as </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>client<span class="token punctuation">.</span><span class="token property-access">user</span><span class="token punctuation">.</span><span class="token property-access">tag</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">!</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// On message sent in discord</span>
client<span class="token punctuation">.</span><span class="token method function property-access">on</span><span class="token punctuation">(</span><span class="token string">'message'</span><span class="token punctuation">,</span> <span class="token parameter">msg</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
    <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span>client<span class="token punctuation">.</span><span class="token property-access">user</span><span class="token punctuation">.</span><span class="token property-access">id</span> <span class="token operator">!==</span> msg<span class="token punctuation">.</span><span class="token property-access">author</span><span class="token punctuation">.</span><span class="token property-access">id</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">processing </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>msg<span class="token punctuation">.</span><span class="token property-access">content</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Perform the login, which initializes a websocket connection.</span>
client<span class="token punctuation">.</span><span class="token method function property-access">login</span><span class="token punctuation">(</span><span class="token constant">CLIENT_LOGIN_KEY</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div>
<p>Replace the CLIENT_LOGIN_KEY assignment to your preferred method to retrieve a key. My particular setup looks exactly like this, where local development always uses a development bot key, and production pulls an environment variable. If you plan on hosting your code in a public repository, you should consider alternative methods of storing your token, such as using dotenv, as hosting secrets of any kind in code is bad practice. For our demo purposes and simple hosting purposes, this will be fine.</p>
<p>We can simply run this code, and our bot should work!</p>
<div class="nuxt-content-highlight"><pre class="line-numbers language-bash"><code>node index.js
</code></pre></div>
<p>You should be greeted with a console message:</p>
<div class="nuxt-content-highlight"><pre class="line-numbers language-text"><code>Logged in as Your-Bot-Username#####!
</code></pre></div>
<p>Success. You have officially put your Discord bot online, and it’s ready to work. You can start typing messages into any channel in your test server that your bot has access to, and your node process should spit out the contents of those messages.</p>
<p>Now, let’s write some basic code to interpret a specific type of message and respond to it.</p>
<p>Lets create a folder and a file for a Command class, which is how we will model actions that should respond to particular phrases or words typed into Discord.</p>
<div class="nuxt-content-highlight"><pre class="line-numbers language-bash"><code><span class="token function">touch</span> commands/Command.js
</code></pre></div>
<p>Open up the Command.js file in a text editor, and paste this starter code:</p>
<div class="nuxt-content-highlight"><span class="filename">Command.js</span><pre class="line-numbers language-js"><code><span class="token comment">// commands/Command.js</span>
module<span class="token punctuation">.</span><span class="token property-access">exports</span> <span class="token operator">=</span> <span class="token keyword">class</span> <span class="token class-name">Command</span> <span class="token punctuation">{</span>

    <span class="token comment">// Basic constructor to set some necessary variables.</span>
    <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">command</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token property-access">prefix</span> <span class="token operator">=</span> <span class="token string">'!'</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token property-access">_command</span> <span class="token operator">=</span> command<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// The main function that will be invoked if the command matches.</span>
    <span class="token function">handler</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">This command is registered but does not have an explicit callback override.</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">get</span> <span class="token function">command</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token punctuation">{</span>
        <span class="token keyword control-flow">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token property-access">_command</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">set</span> <span class="token function">message</span><span class="token punctuation">(</span><span class="token parameter">m</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token property-access">_message</span> <span class="token operator">=</span> m<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// This needs to operate outside of the normal invoke, before a message might be set.</span>
    <span class="token comment">// Responsible for parsing a message and determining if the message matches the command.</span>
    <span class="token function">matchesCommand</span><span class="token punctuation">(</span><span class="token parameter">message</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token property-access">message</span> <span class="token operator">=</span> message 
        <span class="token keyword">let</span> beginsWithPrefix <span class="token operator">=</span> message<span class="token punctuation">.</span><span class="token property-access">content</span><span class="token punctuation">.</span><span class="token method function property-access">charAt</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token property-access">prefix</span>
        <span class="token keyword">let</span> matchesCommand <span class="token operator">=</span> message<span class="token punctuation">.</span><span class="token property-access">content</span><span class="token punctuation">.</span><span class="token method function property-access">substring</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token property-access">command</span><span class="token punctuation">.</span><span class="token property-access">length</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token property-access">_command</span>
        <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span>beginsWithPrefix <span class="token operator">&&</span> matchesCommand<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Command matches.</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword control-flow">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Command does not match.</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword control-flow">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// A core function to be called to invoke the current command handle function.</span>
    <span class="token function">invoke</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token method function property-access">handler</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>


    <span class="token comment">// An optional command to retrieve explanation about a particular command.</span>
    <span class="token function">explainCommand</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">This command is invoked by </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token property-access">prefix</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token property-access">command</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">.</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// This should retrieve the message argument in the given message string</span>
    <span class="token function">getMessageArgument</span><span class="token punctuation">(</span><span class="token parameter">argnumber</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// Parse the message string and return the argument at the index, split by space</span>
        <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token property-access">_message</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">let</span> split <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token property-access">_message</span><span class="token punctuation">.</span><span class="token method function property-access">split</span><span class="token punctuation">(</span><span class="token string">" "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span>split<span class="token punctuation">.</span><span class="token property-access">length</span> <span class="token operator">>=</span> argnumber <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword control-flow">return</span> split<span class="token punctuation">[</span>argnumber<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// implying that arg0 is the prefix</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre></div>
<p>This Command class is intended to be the interface for all commands built into our bot. Noting a few important pieces of the class:</p>
<ul>
<li>The constructor is used to register the word or phrase that the command will respond to. We also save the discord message in the command to interface with it directly.</li>
<li>A <code>matchesCommand</code> function can parse a discord message and detect if the current command is being requested.</li>
<li>The <code>getMessageArgument</code> function can return parts of the discord message after the required prefix.</li>
<li>Let’s keep things simple for now, and create a basic command off of this class.</li>
</ul>
<div class="nuxt-content-highlight"><pre class="line-numbers language-bash"><code><span class="token function">touch</span> commands/Time.js
</code></pre></div>
<p>This basic function will return us the current time according to the bot. Here is the minimal code that is required to run:</p>
<div class="nuxt-content-highlight"><span class="filename">Time.js</span><pre class="line-numbers language-js"><code><span class="token comment">// commands/Time.js</span>
<span class="token keyword">const</span> <span class="token maybe-class-name">Command</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./Command.js'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

module<span class="token punctuation">.</span><span class="token property-access">exports</span> <span class="token operator">=</span> <span class="token keyword">class</span> <span class="token class-name">extends</span> <span class="token maybe-class-name">Command</span> <span class="token punctuation">{</span>

    <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">super</span><span class="token punctuation">(</span><span class="token string">'time'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token function">handler</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token property-access">_message</span><span class="token punctuation">.</span><span class="token property-access">channel</span><span class="token punctuation">.</span><span class="token method function property-access">send</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre></div>
<p>Extremely simple! Here we can see we simply inherit the properties of the parent Command class, and we override the constructor to register a command !time, and define a handler that can simply return the current time in a readable format.</p>
<p>Let’s bring this all together. Back to index.js:</p>
<div class="nuxt-content-highlight"><span class="filename">index.js</span><pre class="line-numbers language-js"><code><span class="token comment">// index.js</span>
<span class="token comment">// Import all necessary libraries, commands, and functions.</span>
<span class="token keyword">const</span> <span class="token maybe-class-name">Discord</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'discord.js'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> client <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Discord<span class="token punctuation">.</span>Client</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token maybe-class-name">TimeCommand</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./commands/Time.js'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> http <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'http'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token constant">CLIENT_LOGIN_KEY</span> <span class="token operator">=</span> process<span class="token punctuation">.</span><span class="token property-access">env</span><span class="token punctuation">.</span><span class="token constant">CLIENT_LOGIN_KEY</span> <span class="token operator">||</span> <span class="token string">'Your-Dev-Bot-Token-Here'</span><span class="token punctuation">;</span>

<span class="token keyword">let</span> commands <span class="token operator">=</span> <span class="token punctuation">[</span>
    <span class="token keyword">new</span> <span class="token class-name">TimeCommand</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token comment">// When the bot is logged in and ready to go</span>
client<span class="token punctuation">.</span><span class="token method function property-access">on</span><span class="token punctuation">(</span><span class="token string">'ready'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
    <span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Logged in as </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>client<span class="token punctuation">.</span><span class="token property-access">user</span><span class="token punctuation">.</span><span class="token property-access">tag</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">!</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// On message sent in discord</span>
client<span class="token punctuation">.</span><span class="token method function property-access">on</span><span class="token punctuation">(</span><span class="token string">'message'</span><span class="token punctuation">,</span> <span class="token parameter">msg</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
    <span class="token comment">// We want to avoid responding to ourselves.</span>
    <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span>client<span class="token punctuation">.</span><span class="token property-access">user</span><span class="token punctuation">.</span><span class="token property-access">id</span> <span class="token operator">!==</span> msg<span class="token punctuation">.</span><span class="token property-access">author</span><span class="token punctuation">.</span><span class="token property-access">id</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">processing </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>msg<span class="token punctuation">.</span><span class="token property-access">content</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// Search for the first command that matches the provided message.</span>
        <span class="token keyword">let</span> i <span class="token operator">=</span> commands<span class="token punctuation">.</span><span class="token method function property-access">findIndex</span><span class="token punctuation">(</span><span class="token parameter">c</span> <span class="token arrow operator">=></span> c<span class="token punctuation">.</span><span class="token method function property-access">matchesCommand</span><span class="token punctuation">(</span>msg<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span>i <span class="token operator">!==</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            commands<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token method function property-access">invoke</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Perform the login, which initializes a websocket connection.</span>
client<span class="token punctuation">.</span><span class="token method function property-access">login</span><span class="token punctuation">(</span><span class="token constant">CLIENT_LOGIN_KEY</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div>
<p>Here we have imported our new command and added some logic to detect and run commands based on the last discord message. Now we can run our bot and test:</p>
<div class="nuxt-content-highlight"><pre class="line-numbers language-bash"><code>node index.js
</code></pre></div>
<p>In your discord test server, in a chat channel which your bot has access to, type !time. The bot should post a message with the current server time! Success, we have built the basic fundamentals of a bot that can respond to discord messages in real time.</p>
<h3 id="hosting-your-bot-on-digitalocean"><a href="#hosting-your-bot-on-digitalocean" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Hosting Your Bot on DigitalOcean</h3>
<p>In order to host our bot effectively, we will need to put our project into source control. Feel free to git init this project how you see fit, just make sure to have a .gitignore file that mentions node_modules, so we aren’t attempting to upload large dependency trees.</p>
<p>I recommend hosting your project in a private Github repository on your account. The DigitalOcean platform interfaces nicely with Github and that will be essential for the ease of deployment in this case.</p>
<p>One last thing we need to add before hosting our app – DigitalOcean requires that our app respond to a “health check” – if you are not familiar with this concept, it is essentially a quick HTTP request that DigitalOcean sends to your app to verify that it is functioning properly. Simply add this block of code to your index.js file, right above your commands array definition:</p>
<div class="nuxt-content-highlight"><pre class="line-numbers language-js"><code>http<span class="token punctuation">.</span><span class="token method function property-access">createServer</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    res<span class="token punctuation">.</span><span class="token method function property-access">writeHead</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token string">'Content-Type'</span><span class="token operator">:</span> <span class="token string">'text/plain'</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    res<span class="token punctuation">.</span><span class="token method function property-access">write</span><span class="token punctuation">(</span><span class="token string">'YourBotName Online.'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    res<span class="token punctuation">.</span><span class="token method function property-access">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">listen</span><span class="token punctuation">(</span><span class="token number">8080</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div>
<p>We have already imported the http library, but in case you had omitted that, make sure it still exists at the top of your index.js file. Of course you are free to add more robust web server libraries such as express if you so choose, but for our simple purposes, no dependencies are necessary.</p>
<p>Once you are ready, make sure to upload your code to the remote private Github repository, and we can get started with DigitalOcean.</p>
<p>Once you are ready, make sure to head to DigitalOcean’s website and log into an existing account/make a new account. Be aware that at the time of writing this, there is no free tier for DigitalOcean so you will need to tie a payment method to your account in order to host an app. Once you are done with this, head over to <a href="https://cloud.digitalocean.com/apps" rel="nofollow noopener noreferrer" target="_blank">https://cloud.digitalocean.com/apps</a> and create a new app.</p>
<p>There might be a few interfaces DigitalOcean will bring you through before you can create your first app, such as connecting your Github account, setting some base permissions, etc. Once you make it to step one of creating your app on the platform, you should be prompted to connect a code repository.</p>
<figure class="article-image" data-v-3be05b54><img src="/_nuxt/img/digital-ocean-connect-code.0b202db.png" alt="DigitalOcean App Platform interface for connecting a code repository." style="max-width:900px" data-v-3be05b54> <figcaption data-v-3be05b54>DigitalOcean App Platform interface for connecting a code repository.</figcaption></figure>
<p>Next, you should be prompted to create a name for your app, choose the hosting region, and set the branch you want your code to be pulled from. When ready, you can move onto the next step, which should pull and autodetect your code. Keep in mind that the platform will not be able to detect your app if it is hosted in a subfolder in your repository – the entry point to your app must be in the root directory. There are methods to host projects in subfolders, but we will not be covering those in this tutorial.</p>
<p>The platform should detect a JavaScript environment, and ask you to confirm some final details about your app. As you make it through these prompts and details, add and verify a few things:</p>
<ul>
<li>You should make sure that any health check HTTP ports are set to the port you defined in your index.js file, which in this demo was 8080</li>
<li>You should make sure to set an environment variable for your CLIENT_LOGIN_KEY to your discord bot token, especially if you are separating your production and local development bots. I set this as an application-level environment variable.</li>
<li>You can certainly choose the smallest hosting capability to start – I run a production bot on the smallest $5/month service for a small amount of users and never come close to my limits.</li>
<li>If prompted, for our purposes you shouldn’t need to add any additional ‘components’ such as a database. The singular NodeJS service should work just fine.</li>
<li>Once configured and you make it through all of the prompts, DigitalOcean should attempt to launch your app. It will do so by pulling a relevant Docker image for your environment, and then attempt to run your app. You should be able to follow the logs directly in browser. Once running, DigitalOcean will attempt to check the health of your application as well. Hopefully your logs will display your “Logged In” message, and if so, your bot should be online in your test server!</li>
</ul>
<h3 id="building-off-of-this-demo-some-additional-strategies-for-development"><a href="#building-off-of-this-demo-some-additional-strategies-for-development" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Building Off of This Demo? Some Additional Strategies for Development</h3>
<p>This demo was extremely simple and intended to give a foundation to building your own bot for Discord. If you plan on building off of this demo or extending it to your needs, I have a few pieces of advice that might help you on your journey. Some initial things I learned while hosting an app in a production environment for external users:</p>
<ul>
<li>Keep notes. In my code repositories I keep a notes/ directory with plenty of tips and instructions on development, deployment, secret keys locations, links to dashboards, etc. This helps when returning to the project after a few months and needing to add the bot to another server, for example, and remembering how to do that. I kept notes on the OAuth2 URLs, permission integers, etc.</li>
<li>Environment variables are your friend – use them. They can make your app versatile to different environments and provide a much better experience developing your bot locally without the risk of live messages flowing through your test changes.</li>
<li>Set up a Command Manager, an overarching class that you can register commands to and that can hold all of the logic for matching discord messages to your custom commands. Our Command class acts as an interface, and thus collecting several commands and managing them through a single CommandManager class can help organize the chaos, or help display help information/tips to users, etc. A CommandManager class is also a decent way to add ‘register’ functionality to your app, such as enabling or disabling the commands for particular discord servers.</li>
<li>Prefix your commands with something unique – a robust Discord server will have many bots and custom bots installed, which all attempt to define ‘commands’. If you end up keeping general names for your commands such as !time, you run the risk of conflicting with other bots (which may or may not be intended). Prefixing with a unique character or set of letters/numbers can help with command organization and end user experience.</li>
</ul>
<p>Lastly, I’ve now released a Part 2 of this tutorial going over some more advanced bot operations, such as interfacing with an API and returning beautiful embedded messages. If you liked this tutorial, ran into issues, or had any comments on this type of content – shoot me an email and let me hear your thoughts!</p></div></div></div></div></div><script defer src="/_nuxt/static/1648826722/articles/creating-and-hosting-a-simple-discord-bot/state.js"></script><script src="/_nuxt/d742747.js" defer></script><script src="/_nuxt/381879a.js" defer></script><script src="/_nuxt/4e74c3e.js" defer></script><script src="/_nuxt/900b283.js" defer></script><script src="/_nuxt/87eb4cc.js" defer></script><script src="/_nuxt/eb224da.js" defer></script>
  </body>
</html>
