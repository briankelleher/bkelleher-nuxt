<!doctype html>
<html data-n-head-ssr lang="en" data-n-head="%7B%22lang%22:%7B%22ssr%22:%22en%22%7D%7D">
  <head>
    <title>Brian Kelleher</title><meta data-n-head="ssr" charset="utf-8"><meta data-n-head="ssr" name="viewport" content="width=device-width,initial-scale=1"><meta data-n-head="ssr" data-hid="description" name="description" content=""><meta data-n-head="ssr" name="format-detection" content="telephone=no"><link data-n-head="ssr" rel="icon" type="image/x-icon" href="/favicon.ico"><link rel="preload" href="/_nuxt/d742747.js" as="script"><link rel="preload" href="/_nuxt/900b283.js" as="script"><link rel="preload" href="/_nuxt/87eb4cc.js" as="script"><link rel="preload" href="/_nuxt/eb224da.js" as="script"><link rel="preload" href="/_nuxt/381879a.js" as="script"><style data-vue-ssr-id="b13bd09c:0 b13bd09c:1 517a8dd7:0 fa7ff0ca:0 7783a668:0 166b59b9:0 2f9548d1:0">@import url(https://fonts.googleapis.com/css2?family=Archivo+Narrow:wght@400;700&family=Merriweather:ital,wght@0,300;0,700;1,300&display=swap);.dark-btn{cursor:pointer;text-decoration:underline;color:#00f}html.dark,html.dark body{background-color:#15202b;color:#fff}html.dark body a,html.dark body a:visited{color:#fff}html.dark body .post .post-tags a{color:#000}html.dark body .article-row .article-read-more,html.dark body .article-row .article-title-link,html.dark body .post .post-tags a:hover{color:#fff}*{font-family:Merriweather,serif}html{background-color:#f1f1f1}h1,h2,h3,h4,h5,h6{font-family:"Archivo Narrow",sans-serif;font-weight:700}h1,h2{font-size:40px}h3{font-size:30px}.nuxt-content-container h3{font-size:48px}body{margin:0}.contain{max-width:1070px;margin:0 auto;padding:0 32px}.page{margin-top:24px}.page.contain{max-width:1070px;margin:0 auto}.row{display:flex;grid-column-gap:20px;-moz-column-gap:20px;column-gap:20px}.row .col{flex:1}.article-row{padding-top:24px;padding-bottom:24px;margin-bottom:8px}.article-row .article-type{color:grey;letter-spacing:1px;text-transform:uppercase;font-family:sans-serif;font-size:12px;margin:0 0 8px}.article-row .article-title-link{text-decoration:none;color:#000;font-family:"Archivo Narrow",sans-serif;font-weight:700}.article-row .article-title-link:hover{text-decoration:underline}.article-row .article-title{margin-top:0;margin-bottom:20px}.article-row .article-excerpt{font-size:18px;line-height:1.8}.article-row .article-excerpt>*{margin-top:0;margin-bottom:16px}.article-row .article-read-more{color:#00f}.post .post-title{font-size:48px}.post .post-content{max-width:78ch;line-height:1.8;font-size:20px}.post .post-content>*{margin:0 0 32px}.post .post-content *+h2,.post .post-content *+h3,.post .post-content *+h4,.post .post-content *+h5,.post .post-content *+h6{margin-top:88px}.post .post-content pre{overflow-x:visible}.post .post-content pre.no-wrap{overflow-x:scroll}@media(max-width:1000px){.post .post-content pre.wp-block-code,.post .post-content pre.wp-block-preformatted{overflow-x:scroll}}.post .post-categories,.post .post-tags{margin-bottom:24px}.post .post-tags{max-width:100%;display:flex;flex-wrap:wrap;align-content:space-between}.post .post-tags a{font-family:"Archivo Narrow",sans-serif;font-weight:400;letter-spacing:1px;padding:6px 24px;margin-right:16px;margin-bottom:16px;text-decoration:none;background:#eaeaea;border-radius:15px;color:#000;font-size:16px}.post .post-tags a:hover{background-color:#15202b;color:#fff}.post .post-project-link{color:#fff;margin-bottom:24px;display:inline-block;padding:8px 24px;letter-spacing:1px;font-family:"Archivo Narrow",sans-serif;text-decoration:none;font-weight:700;text-transform:uppercase;background-color:#385bda;box-shadow:0 5px #0420ad;border-radius:4px}.post .post-project-link:hover{color:#fff;box-shadow:0 3px #0420ad;top:2px;position:relative}pre[class*=language-] span.token{background-color:transparent}.nuxt-content-highlight pre[class*=language-],pre[class*=language-]{white-space:pre-wrap;font-family:monospace;padding:20px;background-color:#000;color:#fff;font-size:16px;border-radius:5px;font-weight:400;text-shadow:none}.nuxt-content-highlight pre[class*=language-].no-wrap,pre[class*=language-].no-wrap{white-space:pre;overflow-x:visible}@media(max-width:1000px){.nuxt-content-highlight pre[class*=language-],.nuxt-content-highlight pre[class*=language-].wp-block-preformatted,pre[class*=language-],pre[class*=language-].wp-block-preformatted{white-space:pre}}code{font-family:monospace}@media(max-width:1000px){code{white-space:pre}}@media(max-width:1000px){.wp-block-code{overflow-x:scroll}}.wp-block-code.no-wrap code{white-space:pre}@media(max-width:1000px){.wp-block-code code{white-space:pre}}.page code[class*=language-],.page pre[class*=language-]{font-size:15px}.page code[class*=language-],.page code[class*=language-] span,.page pre[class*=language-],.page pre[class*=language-] span{font-family:Consolas,Monaco,"Andale Mono","Ubuntu Mono",monospace}figure{margin-top:0}figure img{max-width:100%;height:auto}figure figcaption{font-size:13px;min-width:300px}figure.aligncenter figcaption{text-align:center}footer{min-height:150px}code[class*=language-],pre[class*=language-]{color:#000;background:0 0;text-shadow:0 1px #fff;font-family:Consolas,Monaco,"Andale Mono","Ubuntu Mono",monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-ms-hyphens:none;hyphens:none}code[class*=language-] ::-moz-selection,code[class*=language-]::-moz-selection,pre[class*=language-] ::-moz-selection,pre[class*=language-]::-moz-selection{text-shadow:none;background:#b3d4fc}code[class*=language-] ::selection,code[class*=language-]::selection,pre[class*=language-] ::selection,pre[class*=language-]::selection{text-shadow:none;background:#b3d4fc}@media print{code[class*=language-],pre[class*=language-]{text-shadow:none}}pre[class*=language-]{padding:1em;margin:.5em 0;overflow:auto}:not(pre)>code[class*=language-],pre[class*=language-]{background:#f5f2f0}:not(pre)>code[class*=language-]{padding:.1em;border-radius:.3em;white-space:normal}.token.cdata,.token.comment,.token.doctype,.token.prolog{color:#708090}.token.punctuation{color:#999}.token.namespace{opacity:.7}.token.boolean,.token.constant,.token.deleted,.token.number,.token.property,.token.symbol,.token.tag{color:#905}.token.attr-name,.token.builtin,.token.char,.token.inserted,.token.selector,.token.string{color:#690}.language-css .token.string,.style .token.string,.token.entity,.token.operator,.token.url{color:#9a6e3a;background:hsla(0,0%,100%,.5)}.token.atrule,.token.attr-value,.token.keyword{color:#07a}.token.class-name,.token.function{color:#dd4a68}.token.important,.token.regex,.token.variable{color:#e90}.token.bold,.token.important{font-weight:700}.token.italic{font-style:italic}.token.entity{cursor:help}.nuxt-progress{position:fixed;top:0;left:0;right:0;height:2px;width:0;opacity:1;transition:width .1s,opacity .4s;background-color:#000;z-index:999999}.nuxt-progress.nuxt-progress-notransition{transition:none}.nuxt-progress-failed{background-color:red}.default-layout[data-v-60df20fd]{margin-top:40px;margin-bottom:60px}.top-bar .site-header .header-link[data-v-40d14d74]{text-decoration:none;color:#000}.top-bar .site-header .header-description[data-v-40d14d74]{color:#8a8a8a;font-family:sans-serif;font-weight:400;font-size:18px}.top-bar .top-bar-nav[data-v-40d14d74]{border-bottom:1px solid #d0cfcf;list-style-type:none;padding:0 0 24px;display:flex;justify-content:flex-start;align-items:center;grid-column-gap:16px;-moz-column-gap:16px;column-gap:16px}.top-bar .top-bar-nav .navigation-link[data-v-40d14d74]{color:#00f}.dark .top-bar .site-header .header-link[data-v-40d14d74],.dark .top-bar .top-bar-nav .navigation-link[data-v-40d14d74]{color:#fff}.dark .article-slug .article-meta{color:#c1c5cb}.article-slug{margin-top:30px}.article-slug h2{font-size:60px;margin-bottom:4px}.article-slug .article-meta{font-family:"Archivo Narrow",sans-serif;margin-bottom:60px;font-size:18px;color:#525252}.article-slug .nuxt-content{line-height:1.8;font-size:20px;margin-bottom:60px}.article-slug .nuxt-content>*{margin:0 0 32px}.article-slug .nuxt-content *+h2,.article-slug .nuxt-content *+h3,.article-slug .nuxt-content *+h4,.article-slug .nuxt-content *+h5,.article-slug .nuxt-content *+h6{margin-top:88px}.article-slug .nuxt-content pre{overflow-x:visible;font-family:monospace}.article-slug .nuxt-content pre code,.article-slug .nuxt-content pre code span{font-family:monospace}.article-slug .nuxt-content .nuxt-content-highlight{background-color:rgba(38,38,38,.54);border-top-left-radius:5px;border-top-right-radius:5px}.article-slug .nuxt-content .nuxt-content-highlight span.filename{font-family:monospace;font-size:14px;margin-left:20px}</style><link rel="preload" href="/_nuxt/static/1648826722/articles/simple-js-dark-mode/state.js" as="script"><link rel="preload" href="/_nuxt/static/1648826722/articles/simple-js-dark-mode/payload.js" as="script"><link rel="preload" href="/_nuxt/static/1648826722/manifest.js" as="script">
  </head>
  <body>
    <div data-server-rendered="true" id="__nuxt"><!----><div id="__layout"><div class="default-layout" data-v-60df20fd><div class="top-bar contain" data-v-40d14d74 data-v-60df20fd><header class="site-header" data-v-40d14d74><a href="/" class="header-link nuxt-link-active" data-v-40d14d74><h1 data-v-40d14d74>Brian Kelleher</h1></a> <a class="btn dark-btn" data-v-40d14d74>Toggle Dark Mode</a> <h1 class="header-description" data-v-40d14d74>
      Full-Stack Web Developer in Denver, CO
    </h1></header> <nav class="top-bar-nav contain" data-v-40d14d74><a href="/articles" class="nuxt-link-active" data-v-40d14d74>
      Articles
    </a> <a href="https://twitter.com/b_kelleher" data-v-40d14d74>Twitter</a></nav></div> <div class="article-slug contain" data-v-60df20fd><h2>Simple JavaScript Dark Mode</h2> <p class="article-meta">
    Last Updated: April 1, 2022
  </p> <div class="nuxt-content"><p>In the world of CSS variables and webpack code splitting, there are plenty of ways to integrate a dark mode into your website or app. In my case, I was looking for a dead simple solution to add a subtle dark mode touch, in 100 lines or less, in vanilla. The simple JavaScript solution looks like this:</p>
<div class="nuxt-content-highlight"><span class="filename">index.js</span><pre class="line-numbers language-js"><code><span class="token keyword">function</span> <span class="token function">is_dark_theme</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword control-flow">return</span> <span class="token dom variable">document</span><span class="token punctuation">.</span><span class="token property-access">documentElement</span><span class="token punctuation">.</span><span class="token property-access">className</span> <span class="token operator">===</span> <span class="token string">'dark-theme'</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">var</span> dark_btn <span class="token operator">=</span> <span class="token dom variable">document</span><span class="token punctuation">.</span><span class="token method function property-access">querySelector</span><span class="token punctuation">(</span><span class="token string">'.dark-btn'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> cookie <span class="token operator">=</span> <span class="token dom variable">document</span><span class="token punctuation">.</span><span class="token property-access">cookie</span><span class="token punctuation">.</span><span class="token method function property-access">split</span><span class="token punctuation">(</span><span class="token string">'; '</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">find</span><span class="token punctuation">(</span><span class="token parameter">row</span> <span class="token arrow operator">=></span> row<span class="token punctuation">.</span><span class="token method function property-access">startsWith</span><span class="token punctuation">(</span><span class="token string">'yourprefix_theme='</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> cookie_value <span class="token operator">=</span> <span class="token punctuation">(</span>cookie<span class="token punctuation">)</span> <span class="token operator">?</span> cookie<span class="token punctuation">.</span><span class="token method function property-access">split</span><span class="token punctuation">(</span><span class="token string">'='</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">:</span> <span class="token string">''</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> chose_dark_theme <span class="token operator">=</span> cookie_value <span class="token operator">===</span> <span class="token string">'dark'</span><span class="token punctuation">;</span>

<span class="token comment">// Not necessary, but an optional to match browser/OS preference in some cases.</span>
<span class="token keyword">var</span> prefer_dark_theme <span class="token operator">=</span> <span class="token dom variable">window</span><span class="token punctuation">.</span><span class="token method function property-access">matchMedia</span><span class="token punctuation">(</span><span class="token string">"(prefers-color-scheme: dark)"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token property-access">matches</span><span class="token punctuation">;</span>

<span class="token keyword control-flow">if</span> <span class="token punctuation">(</span> chose_dark_theme <span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token dom variable">document</span><span class="token punctuation">.</span><span class="token property-access">documentElement</span><span class="token punctuation">.</span><span class="token property-access">className</span> <span class="token operator">=</span> <span class="token string">'dark-theme'</span><span class="token punctuation">;</span>
    <span class="token dom variable">document</span><span class="token punctuation">.</span><span class="token property-access">cookie</span> <span class="token operator">=</span> <span class="token string">"yourprefix_theme=dark; path=/;"</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> <span class="token keyword control-flow">else</span> <span class="token punctuation">{</span>
    <span class="token dom variable">document</span><span class="token punctuation">.</span><span class="token property-access">cookie</span> <span class="token operator">=</span> <span class="token string">"yourprefix_theme=; path=/;"</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

dark_btn<span class="token punctuation">.</span><span class="token method function property-access">addEventListener</span><span class="token punctuation">(</span><span class="token string">"click"</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> theme <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">;</span>
    <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span> <span class="token function">is_dark_theme</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token dom variable">document</span><span class="token punctuation">.</span><span class="token property-access">documentElement</span><span class="token punctuation">.</span><span class="token property-access">className</span> <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">;</span>
        theme <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword control-flow">else</span> <span class="token punctuation">{</span>
        <span class="token dom variable">document</span><span class="token punctuation">.</span><span class="token property-access">documentElement</span><span class="token punctuation">.</span><span class="token property-access">className</span> <span class="token operator">=</span> <span class="token string">'dark-theme'</span><span class="token punctuation">;</span>
        theme <span class="token operator">=</span> <span class="token string">'dark'</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token dom variable">document</span><span class="token punctuation">.</span><span class="token property-access">cookie</span> <span class="token operator">=</span> <span class="token string">"yourprefix_theme="</span> <span class="token operator">+</span> theme <span class="token operator">+</span> <span class="token string">"; path=/;"</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div>
<p>Load this snippet in the footer, add a button to the page with a class of “dark-btn”, and you can simply add any CSS styles to your page that account for the <code>&lt;body></code> element to have a class of “dark-theme”.</p>
<p>To create a more consistent user experience for a user, I would recommend doing a basic check in your server side code to add a dark class to the <code>&lt;body></code> element, which will assist with the first paint rather than flashing light content first. For example, with PHP, on a hook that :</p>
<div class="nuxt-content-highlight"><span class="filename">index.php</span><pre class="line-numbers language-php"><code><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>

<span class="token doc-comment comment">/**
 * Returns a class name for the current theme based on user preference.
 * 
 * <span class="token keyword">@return</span> <span class="token class-name">String</span> Class name for the theme, if relevant.
 */</span>
<span class="token keyword">function</span> <span class="token function-definition function">yourprefix_dark_mode_html_class</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token variable">$class</span> <span class="token operator">=</span> <span class="token string single-quoted-string">''</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token operator">!</span><span class="token keyword">empty</span><span class="token punctuation">(</span><span class="token global">$_COOKIE</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'yourprefix_theme'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token global">$_COOKIE</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'yourprefix_theme'</span><span class="token punctuation">]</span> <span class="token operator">===</span> <span class="token string single-quoted-string">'dark'</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token variable">$class</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'dark-theme'</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token global">$_COOKIE</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'yourprefix_theme'</span><span class="token punctuation">]</span> <span class="token operator">===</span> <span class="token string single-quoted-string">''</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token variable">$class</span> <span class="token operator">=</span> <span class="token string single-quoted-string">''</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token variable">$class</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token doc-comment comment">/**
 * In your template file:
 */</span>
<span class="token delimiter important">?></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token php language-php"><span class="token delimiter important">&lt;?php</span> <span class="token keyword">echo</span> <span class="token function">yourprefix_dark_mode_html_class</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token delimiter important">?></span></span><span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
</code></pre></div>
<p>Some interesting things I discovered when playing with this simple snippet:</p>
<ul>
<li>Setting a path in the cookie is critical to future maintenance of your ‘dark mode’ functionality. If you aren’t careful to set this, cookies will be assumed on the path where the dark mode was triggered, which could cause page navigation changes to lose the dark mode preference. If two cookies exist, the broader path will not be read without some additional checks.</li>
<li>Setting a blank value is required to reset the value of cookies in most cases, unless the cookie is allowed to expire</li>
<li>The cookie will expire based on session, so typically will not persist past 20 minutes after a session. You can easily modify this by setting an <code>;expires=&lt;UTCstring></code> between the cookie name and the path. In my case, I just wanted to cover the current session a user was in.</li>
<li>You can easily get really complicated with this:
<ul>
<li>Taking into account a browser/OS dark mode preference</li>
<li>Persisting a user preference to a dataset</li>
<li>Adding multiple different themes, using CSS variables to swap common values</li>
</ul>
</li>
</ul></div></div></div></div></div><script defer src="/_nuxt/static/1648826722/articles/simple-js-dark-mode/state.js"></script><script src="/_nuxt/d742747.js" defer></script><script src="/_nuxt/381879a.js" defer></script><script src="/_nuxt/900b283.js" defer></script><script src="/_nuxt/87eb4cc.js" defer></script><script src="/_nuxt/eb224da.js" defer></script>
  </body>
</html>
